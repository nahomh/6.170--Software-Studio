.row-fluid
  .span3
    -if current_user
      .friends.well
        -@friends.each do |friend|
          .media.friend{:id => friend.id}

            = link_to image_tag(@graph.get_picture(friend.uid), :class => "img-rounded media-object pull-left") ,friend, :class => "pull-left"
            .media-body
              %h5.media-heading= link_to friend.name, friend
              .occupying
                -if friend.room
                  %address is studying in #{friend.room.name}
                -else 
                  %address isn't studying right now.
      
  .span9
    .room-search
      =form_tag root_path, :method => "get", :class => "rooms-search" do
        ="enter building or building-room number: "
        = hidden_field_tag :order, params[:order]
        = hidden_field_tag :sort, params[:sort]
        = hidden_field_tag :projector_available, params[:projector_available]
        = hidden_field_tag :whiteboard_available, params[:whiteboard_available]
        -if params[:page]
          = hidden_field_tag :page, params[:page]
        = text_field_tag :search, params[:search], :id => 'search_field' 
        = submit_tag "Search", :name => nil, :class => "btn"
        -if params[:projector_available] == "yes"
          %li
            = link_to params.merge(:projector_available => "no") do 
              = succeed "Show only Facebook friends" do
                %i.icon-check
        -else
          %li
            = link_to ({:facebook => "yes", :completed => params[:completed], :sort => params[:sort], :order => params[:order]}) do 
              = succeed "Show only Facebook friends" do
                %i.icon-check-empty
        -if params[:completed] == "yes"
          %li
            = link_to ({:facebook => params[:facebook], :sort => params[:sort], :order => params[:order]}) do 
              = succeed "Show only released convicts" do
                %i.icon-check
        -else
          %li
            = link_to ({:completed => "yes", :facebook => params[:facebook], :sort => params[:sort], :order => params[:order]}) do 
              = succeed "Show only released convicts" do
                %i.icon-check-empty

        .rooms-table
          =render :partial => "rooms/table", :locals => {:rooms => @rooms, :sort => nil, :order => nil, :page => nil}
    =will_paginate @rooms
    %br
    .map_container
      .gmaps4rails_map#map
        .span9#map_canvas
          .hidden-phone=gmaps("map_options" => { "detect_location" => true, "bounds" =>'[{"lat":42.36311,"lng":-71.110425},{"lat":42.350711,"lng":-71.076908}]'},"markers" => { "data" => @json })

